{"remainingRequest":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tajirhas9/varsity/software_engineering/ctas/client/src/components/HeaderSearch/index.vue?vue&type=style&index=0&id=032bd1f0&lang=scss&scoped=true&","dependencies":[{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/src/components/HeaderSearch/index.vue","mtime":1640465303000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5oZWFkZXItc2VhcmNoIHsKICBmb250LXNpemU6IDAgIWltcG9ydGFudDsKCiAgLnNlYXJjaC1pY29uIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CiAgfQoKICAuaGVhZGVyLXNlYXJjaC1zZWxlY3QgewogICAgZm9udC1zaXplOiAxOHB4OwogICAgdHJhbnNpdGlvbjogd2lkdGggMC4yczsKICAgIHdpZHRoOiAwOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgYm9yZGVyLXJhZGl1czogMDsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7CgogICAgLmVsLWlucHV0X19pbm5lciB7CiAgICAgIGJvcmRlci1yYWRpdXM6IDA7CiAgICAgIGJvcmRlcjogMDsKICAgICAgcGFkZGluZy1sZWZ0OiAwOwogICAgICBwYWRkaW5nLXJpZ2h0OiAwOwogICAgICBib3gtc2hhZG93OiBub25lICFpbXBvcnRhbnQ7CiAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZDlkOWQ5OwogICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogICAgfQogIH0KCiAgJi5zaG93IHsKICAgIC5oZWFkZXItc2VhcmNoLXNlbGVjdCB7CiAgICAgIHdpZHRoOiAyMTBweDsKICAgICAgbWFyZ2luLWxlZnQ6IDEwcHg7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqLA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/HeaderSearch","sourcesContent":["<template>\n  <div\n    id=\"header-search\"\n    :class=\"{'show': show}\"\n    class=\"header-search\"\n  >\n    <svg-icon\n      class=\"search-icon\"\n      name=\"search\"\n      @click.stop=\"click\"\n    />\n    <el-select\n      ref=\"headerSearchSelect\"\n      v-model=\"search\"\n      :remote-method=\"querySearch\"\n      filterable\n      default-first-option\n      remote\n      placeholder=\"Search\"\n      class=\"header-search-select\"\n      @change=\"change\"\n    >\n      <el-option\n        v-for=\"item in options\"\n        :key=\"item.path\"\n        :value=\"item\"\n        :label=\"item.meta.title.join(' > ')\"\n      />\n    </el-select>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport path from 'path'\nimport Fuse from 'fuse.js' // A lightweight fuzzy-search module\nimport { Component, Vue, Watch } from 'vue-property-decorator'\nimport { RouteConfig } from 'vue-router'\nimport { AppModule } from '@/store/modules/app'\nimport { PermissionModule } from '@/store/modules/permission'\nimport i18n from '@/lang' // Internationalization\n\n@Component({\n  name: 'HeaderSearch'\n})\nexport default class extends Vue {\n  private search = ''\n  private show = false\n  private options: RouteConfig[] = []\n  private searchPool: RouteConfig[] = []\n  private fuse?: Fuse<RouteConfig>\n\n  get routes() {\n    return PermissionModule.routes\n  }\n\n  get lang() {\n    return AppModule.language\n  }\n\n  @Watch('lang')\n  private onLangChange() {\n    this.searchPool = this.generateRoutes(this.routes)\n  }\n\n  @Watch('routes')\n  private onRoutesChange() {\n    this.searchPool = this.generateRoutes(this.routes)\n  }\n\n  @Watch('searchPool')\n  private onSearchPoolChange(value: RouteConfig[]) {\n    this.initFuse(value)\n  }\n\n  @Watch('show')\n  private onShowChange(value: boolean) {\n    if (value) {\n      document.body.addEventListener('click', this.close)\n    } else {\n      document.body.removeEventListener('click', this.close)\n    }\n  }\n\n  mounted() {\n    this.searchPool = this.generateRoutes(this.routes)\n  }\n\n  private click() {\n    this.show = !this.show\n    if (this.show) {\n      this.$refs.headerSearchSelect && (this.$refs.headerSearchSelect as HTMLElement).focus()\n    }\n  }\n\n  private close() {\n    this.$refs.headerSearchSelect && (this.$refs.headerSearchSelect as HTMLElement).blur()\n    this.options = []\n    this.show = false\n  }\n\n  private change(route: RouteConfig) {\n    this.$router.push(route.path).catch(err => {\n      console.warn(err)\n    })\n    this.search = ''\n    this.options = []\n    this.$nextTick(() => {\n      this.show = false\n    })\n  }\n\n  private initFuse(list: RouteConfig[]) {\n    this.fuse = new Fuse(list, {\n      shouldSort: true,\n      threshold: 0.4,\n      location: 0,\n      distance: 100,\n      minMatchCharLength: 1,\n      keys: [{\n        name: 'title',\n        weight: 0.7\n      }, {\n        name: 'path',\n        weight: 0.3\n      }]\n    })\n  }\n\n  // Filter out the routes that can be displayed in the sidebar\n  // And generate the internationalized title\n  private generateRoutes(routes: RouteConfig[], basePath = '/', prefixTitle: string[] = []) {\n    let res: RouteConfig[] = []\n\n    for (const router of routes) {\n      // skip hidden router\n      if (router.meta && router.meta.hidden) {\n        continue\n      }\n\n      const data: RouteConfig = {\n        path: path.resolve(basePath, router.path),\n        meta: {\n          title: [...prefixTitle]\n        }\n      }\n\n      if (router.meta && router.meta.title) {\n        // generate internationalized title\n        const i18ntitle = i18n.t(`route.${router.meta.title}`).toString()\n        if (data.meta !== undefined) { data.meta.title = [...data.meta?.title, i18ntitle] }\n        if (router.redirect !== 'noRedirect') {\n          // only push the routes with title\n          // special case: need to exclude parent router without redirect\n          res.push(data)\n        }\n      }\n\n      // recursive child routes\n      if (router.children) {\n        const tempRoutes = this.generateRoutes(router.children, data.path, data.meta?.title)\n        if (tempRoutes.length >= 1) {\n          res = [...res, ...tempRoutes]\n        }\n      }\n    }\n    return res\n  }\n\n  private querySearch(query: string) {\n    if (query !== '') {\n      if (this.fuse) {\n        this.options = this.fuse.search(query).map((result) => result.item)\n      }\n    } else {\n      this.options = []\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.header-search {\n  font-size: 0 !important;\n\n  .search-icon {\n    cursor: pointer;\n    font-size: 18px;\n    vertical-align: middle;\n  }\n\n  .header-search-select {\n    font-size: 18px;\n    transition: width 0.2s;\n    width: 0;\n    overflow: hidden;\n    background: transparent;\n    border-radius: 0;\n    display: inline-block;\n    vertical-align: middle;\n\n    .el-input__inner {\n      border-radius: 0;\n      border: 0;\n      padding-left: 0;\n      padding-right: 0;\n      box-shadow: none !important;\n      border-bottom: 1px solid #d9d9d9;\n      vertical-align: middle;\n    }\n  }\n\n  &.show {\n    .header-search-select {\n      width: 210px;\n      margin-left: 10px;\n    }\n  }\n}\n</style>\n"]}]}