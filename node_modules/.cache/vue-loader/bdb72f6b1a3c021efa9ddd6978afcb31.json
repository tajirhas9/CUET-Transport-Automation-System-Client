{"remainingRequest":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tajirhas9/varsity/software_engineering/ctas/client/src/components/HeaderSearch/index.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/src/components/HeaderSearch/index.vue","mtime":1640465303000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHBhdGggZnJvbSAncGF0aCcKaW1wb3J0IEZ1c2UgZnJvbSAnZnVzZS5qcycgLy8gQSBsaWdodHdlaWdodCBmdXp6eS1zZWFyY2ggbW9kdWxlCmltcG9ydCB7IENvbXBvbmVudCwgVnVlLCBXYXRjaCB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InCmltcG9ydCB7IFJvdXRlQ29uZmlnIH0gZnJvbSAndnVlLXJvdXRlcicKaW1wb3J0IHsgQXBwTW9kdWxlIH0gZnJvbSAnQC9zdG9yZS9tb2R1bGVzL2FwcCcKaW1wb3J0IHsgUGVybWlzc2lvbk1vZHVsZSB9IGZyb20gJ0Avc3RvcmUvbW9kdWxlcy9wZXJtaXNzaW9uJwppbXBvcnQgaTE4biBmcm9tICdAL2xhbmcnIC8vIEludGVybmF0aW9uYWxpemF0aW9uCgpAQ29tcG9uZW50KHsKICBuYW1lOiAnSGVhZGVyU2VhcmNoJwp9KQpleHBvcnQgZGVmYXVsdCBjbGFzcyBleHRlbmRzIFZ1ZSB7CiAgcHJpdmF0ZSBzZWFyY2ggPSAnJwogIHByaXZhdGUgc2hvdyA9IGZhbHNlCiAgcHJpdmF0ZSBvcHRpb25zOiBSb3V0ZUNvbmZpZ1tdID0gW10KICBwcml2YXRlIHNlYXJjaFBvb2w6IFJvdXRlQ29uZmlnW10gPSBbXQogIHByaXZhdGUgZnVzZT86IEZ1c2U8Um91dGVDb25maWc+CgogIGdldCByb3V0ZXMoKSB7CiAgICByZXR1cm4gUGVybWlzc2lvbk1vZHVsZS5yb3V0ZXMKICB9CgogIGdldCBsYW5nKCkgewogICAgcmV0dXJuIEFwcE1vZHVsZS5sYW5ndWFnZQogIH0KCiAgQFdhdGNoKCdsYW5nJykKICBwcml2YXRlIG9uTGFuZ0NoYW5nZSgpIHsKICAgIHRoaXMuc2VhcmNoUG9vbCA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXModGhpcy5yb3V0ZXMpCiAgfQoKICBAV2F0Y2goJ3JvdXRlcycpCiAgcHJpdmF0ZSBvblJvdXRlc0NoYW5nZSgpIHsKICAgIHRoaXMuc2VhcmNoUG9vbCA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXModGhpcy5yb3V0ZXMpCiAgfQoKICBAV2F0Y2goJ3NlYXJjaFBvb2wnKQogIHByaXZhdGUgb25TZWFyY2hQb29sQ2hhbmdlKHZhbHVlOiBSb3V0ZUNvbmZpZ1tdKSB7CiAgICB0aGlzLmluaXRGdXNlKHZhbHVlKQogIH0KCiAgQFdhdGNoKCdzaG93JykKICBwcml2YXRlIG9uU2hvd0NoYW5nZSh2YWx1ZTogYm9vbGVhbikgewogICAgaWYgKHZhbHVlKSB7CiAgICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlKQogICAgfSBlbHNlIHsKICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2UpCiAgICB9CiAgfQoKICBtb3VudGVkKCkgewogICAgdGhpcy5zZWFyY2hQb29sID0gdGhpcy5nZW5lcmF0ZVJvdXRlcyh0aGlzLnJvdXRlcykKICB9CgogIHByaXZhdGUgY2xpY2soKSB7CiAgICB0aGlzLnNob3cgPSAhdGhpcy5zaG93CiAgICBpZiAodGhpcy5zaG93KSB7CiAgICAgIHRoaXMuJHJlZnMuaGVhZGVyU2VhcmNoU2VsZWN0ICYmICh0aGlzLiRyZWZzLmhlYWRlclNlYXJjaFNlbGVjdCBhcyBIVE1MRWxlbWVudCkuZm9jdXMoKQogICAgfQogIH0KCiAgcHJpdmF0ZSBjbG9zZSgpIHsKICAgIHRoaXMuJHJlZnMuaGVhZGVyU2VhcmNoU2VsZWN0ICYmICh0aGlzLiRyZWZzLmhlYWRlclNlYXJjaFNlbGVjdCBhcyBIVE1MRWxlbWVudCkuYmx1cigpCiAgICB0aGlzLm9wdGlvbnMgPSBbXQogICAgdGhpcy5zaG93ID0gZmFsc2UKICB9CgogIHByaXZhdGUgY2hhbmdlKHJvdXRlOiBSb3V0ZUNvbmZpZykgewogICAgdGhpcy4kcm91dGVyLnB1c2gocm91dGUucGF0aCkuY2F0Y2goZXJyID0+IHsKICAgICAgY29uc29sZS53YXJuKGVycikKICAgIH0pCiAgICB0aGlzLnNlYXJjaCA9ICcnCiAgICB0aGlzLm9wdGlvbnMgPSBbXQogICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICB0aGlzLnNob3cgPSBmYWxzZQogICAgfSkKICB9CgogIHByaXZhdGUgaW5pdEZ1c2UobGlzdDogUm91dGVDb25maWdbXSkgewogICAgdGhpcy5mdXNlID0gbmV3IEZ1c2UobGlzdCwgewogICAgICBzaG91bGRTb3J0OiB0cnVlLAogICAgICB0aHJlc2hvbGQ6IDAuNCwKICAgICAgbG9jYXRpb246IDAsCiAgICAgIGRpc3RhbmNlOiAxMDAsCiAgICAgIG1pbk1hdGNoQ2hhckxlbmd0aDogMSwKICAgICAga2V5czogW3sKICAgICAgICBuYW1lOiAndGl0bGUnLAogICAgICAgIHdlaWdodDogMC43CiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAncGF0aCcsCiAgICAgICAgd2VpZ2h0OiAwLjMKICAgICAgfV0KICAgIH0pCiAgfQoKICAvLyBGaWx0ZXIgb3V0IHRoZSByb3V0ZXMgdGhhdCBjYW4gYmUgZGlzcGxheWVkIGluIHRoZSBzaWRlYmFyCiAgLy8gQW5kIGdlbmVyYXRlIHRoZSBpbnRlcm5hdGlvbmFsaXplZCB0aXRsZQogIHByaXZhdGUgZ2VuZXJhdGVSb3V0ZXMocm91dGVzOiBSb3V0ZUNvbmZpZ1tdLCBiYXNlUGF0aCA9ICcvJywgcHJlZml4VGl0bGU6IHN0cmluZ1tdID0gW10pIHsKICAgIGxldCByZXM6IFJvdXRlQ29uZmlnW10gPSBbXQoKICAgIGZvciAoY29uc3Qgcm91dGVyIG9mIHJvdXRlcykgewogICAgICAvLyBza2lwIGhpZGRlbiByb3V0ZXIKICAgICAgaWYgKHJvdXRlci5tZXRhICYmIHJvdXRlci5tZXRhLmhpZGRlbikgewogICAgICAgIGNvbnRpbnVlCiAgICAgIH0KCiAgICAgIGNvbnN0IGRhdGE6IFJvdXRlQ29uZmlnID0gewogICAgICAgIHBhdGg6IHBhdGgucmVzb2x2ZShiYXNlUGF0aCwgcm91dGVyLnBhdGgpLAogICAgICAgIG1ldGE6IHsKICAgICAgICAgIHRpdGxlOiBbLi4ucHJlZml4VGl0bGVdCiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAocm91dGVyLm1ldGEgJiYgcm91dGVyLm1ldGEudGl0bGUpIHsKICAgICAgICAvLyBnZW5lcmF0ZSBpbnRlcm5hdGlvbmFsaXplZCB0aXRsZQogICAgICAgIGNvbnN0IGkxOG50aXRsZSA9IGkxOG4udChgcm91dGUuJHtyb3V0ZXIubWV0YS50aXRsZX1gKS50b1N0cmluZygpCiAgICAgICAgaWYgKGRhdGEubWV0YSAhPT0gdW5kZWZpbmVkKSB7IGRhdGEubWV0YS50aXRsZSA9IFsuLi5kYXRhLm1ldGE/LnRpdGxlLCBpMThudGl0bGVdIH0KICAgICAgICBpZiAocm91dGVyLnJlZGlyZWN0ICE9PSAnbm9SZWRpcmVjdCcpIHsKICAgICAgICAgIC8vIG9ubHkgcHVzaCB0aGUgcm91dGVzIHdpdGggdGl0bGUKICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogbmVlZCB0byBleGNsdWRlIHBhcmVudCByb3V0ZXIgd2l0aG91dCByZWRpcmVjdAogICAgICAgICAgcmVzLnB1c2goZGF0YSkKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIHJlY3Vyc2l2ZSBjaGlsZCByb3V0ZXMKICAgICAgaWYgKHJvdXRlci5jaGlsZHJlbikgewogICAgICAgIGNvbnN0IHRlbXBSb3V0ZXMgPSB0aGlzLmdlbmVyYXRlUm91dGVzKHJvdXRlci5jaGlsZHJlbiwgZGF0YS5wYXRoLCBkYXRhLm1ldGE/LnRpdGxlKQogICAgICAgIGlmICh0ZW1wUm91dGVzLmxlbmd0aCA+PSAxKSB7CiAgICAgICAgICByZXMgPSBbLi4ucmVzLCAuLi50ZW1wUm91dGVzXQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIHJlcwogIH0KCiAgcHJpdmF0ZSBxdWVyeVNlYXJjaChxdWVyeTogc3RyaW5nKSB7CiAgICBpZiAocXVlcnkgIT09ICcnKSB7CiAgICAgIGlmICh0aGlzLmZ1c2UpIHsKICAgICAgICB0aGlzLm9wdGlvbnMgPSB0aGlzLmZ1c2Uuc2VhcmNoKHF1ZXJ5KS5tYXAoKHJlc3VsdCkgPT4gcmVzdWx0Lml0ZW0pCiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRoaXMub3B0aW9ucyA9IFtdCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/HeaderSearch","sourcesContent":["<template>\n  <div\n    id=\"header-search\"\n    :class=\"{'show': show}\"\n    class=\"header-search\"\n  >\n    <svg-icon\n      class=\"search-icon\"\n      name=\"search\"\n      @click.stop=\"click\"\n    />\n    <el-select\n      ref=\"headerSearchSelect\"\n      v-model=\"search\"\n      :remote-method=\"querySearch\"\n      filterable\n      default-first-option\n      remote\n      placeholder=\"Search\"\n      class=\"header-search-select\"\n      @change=\"change\"\n    >\n      <el-option\n        v-for=\"item in options\"\n        :key=\"item.path\"\n        :value=\"item\"\n        :label=\"item.meta.title.join(' > ')\"\n      />\n    </el-select>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport path from 'path'\nimport Fuse from 'fuse.js' // A lightweight fuzzy-search module\nimport { Component, Vue, Watch } from 'vue-property-decorator'\nimport { RouteConfig } from 'vue-router'\nimport { AppModule } from '@/store/modules/app'\nimport { PermissionModule } from '@/store/modules/permission'\nimport i18n from '@/lang' // Internationalization\n\n@Component({\n  name: 'HeaderSearch'\n})\nexport default class extends Vue {\n  private search = ''\n  private show = false\n  private options: RouteConfig[] = []\n  private searchPool: RouteConfig[] = []\n  private fuse?: Fuse<RouteConfig>\n\n  get routes() {\n    return PermissionModule.routes\n  }\n\n  get lang() {\n    return AppModule.language\n  }\n\n  @Watch('lang')\n  private onLangChange() {\n    this.searchPool = this.generateRoutes(this.routes)\n  }\n\n  @Watch('routes')\n  private onRoutesChange() {\n    this.searchPool = this.generateRoutes(this.routes)\n  }\n\n  @Watch('searchPool')\n  private onSearchPoolChange(value: RouteConfig[]) {\n    this.initFuse(value)\n  }\n\n  @Watch('show')\n  private onShowChange(value: boolean) {\n    if (value) {\n      document.body.addEventListener('click', this.close)\n    } else {\n      document.body.removeEventListener('click', this.close)\n    }\n  }\n\n  mounted() {\n    this.searchPool = this.generateRoutes(this.routes)\n  }\n\n  private click() {\n    this.show = !this.show\n    if (this.show) {\n      this.$refs.headerSearchSelect && (this.$refs.headerSearchSelect as HTMLElement).focus()\n    }\n  }\n\n  private close() {\n    this.$refs.headerSearchSelect && (this.$refs.headerSearchSelect as HTMLElement).blur()\n    this.options = []\n    this.show = false\n  }\n\n  private change(route: RouteConfig) {\n    this.$router.push(route.path).catch(err => {\n      console.warn(err)\n    })\n    this.search = ''\n    this.options = []\n    this.$nextTick(() => {\n      this.show = false\n    })\n  }\n\n  private initFuse(list: RouteConfig[]) {\n    this.fuse = new Fuse(list, {\n      shouldSort: true,\n      threshold: 0.4,\n      location: 0,\n      distance: 100,\n      minMatchCharLength: 1,\n      keys: [{\n        name: 'title',\n        weight: 0.7\n      }, {\n        name: 'path',\n        weight: 0.3\n      }]\n    })\n  }\n\n  // Filter out the routes that can be displayed in the sidebar\n  // And generate the internationalized title\n  private generateRoutes(routes: RouteConfig[], basePath = '/', prefixTitle: string[] = []) {\n    let res: RouteConfig[] = []\n\n    for (const router of routes) {\n      // skip hidden router\n      if (router.meta && router.meta.hidden) {\n        continue\n      }\n\n      const data: RouteConfig = {\n        path: path.resolve(basePath, router.path),\n        meta: {\n          title: [...prefixTitle]\n        }\n      }\n\n      if (router.meta && router.meta.title) {\n        // generate internationalized title\n        const i18ntitle = i18n.t(`route.${router.meta.title}`).toString()\n        if (data.meta !== undefined) { data.meta.title = [...data.meta?.title, i18ntitle] }\n        if (router.redirect !== 'noRedirect') {\n          // only push the routes with title\n          // special case: need to exclude parent router without redirect\n          res.push(data)\n        }\n      }\n\n      // recursive child routes\n      if (router.children) {\n        const tempRoutes = this.generateRoutes(router.children, data.path, data.meta?.title)\n        if (tempRoutes.length >= 1) {\n          res = [...res, ...tempRoutes]\n        }\n      }\n    }\n    return res\n  }\n\n  private querySearch(query: string) {\n    if (query !== '') {\n      if (this.fuse) {\n        this.options = this.fuse.search(query).map((result) => result.item)\n      }\n    } else {\n      this.options = []\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.header-search {\n  font-size: 0 !important;\n\n  .search-icon {\n    cursor: pointer;\n    font-size: 18px;\n    vertical-align: middle;\n  }\n\n  .header-search-select {\n    font-size: 18px;\n    transition: width 0.2s;\n    width: 0;\n    overflow: hidden;\n    background: transparent;\n    border-radius: 0;\n    display: inline-block;\n    vertical-align: middle;\n\n    .el-input__inner {\n      border-radius: 0;\n      border: 0;\n      padding-left: 0;\n      padding-right: 0;\n      box-shadow: none !important;\n      border-bottom: 1px solid #d9d9d9;\n      vertical-align: middle;\n    }\n  }\n\n  &.show {\n    .header-search-select {\n      width: 210px;\n      margin-left: 10px;\n    }\n  }\n}\n</style>\n"]}]}