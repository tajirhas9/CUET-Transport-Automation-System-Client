{"remainingRequest":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tajirhas9/varsity/software_engineering/ctas/client/src/views/schedule/components/table.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/src/views/schedule/components/table.vue","mtime":1640465303000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tajirhas9/varsity/software_engineering/ctas/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLyoqCiAqIEBEZXZFeF9jb21wb25lbnQKICovCmltcG9ydCB7IENvbXBvbmVudCwgUHJvcCwgV2F0Y2ggfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJwppbXBvcnQgeyBtaXhpbnMgfSBmcm9tICd2dWUtY2xhc3MtY29tcG9uZW50JwppbXBvcnQgVnVlRGV2ZXggZnJvbSAnQC9sYXlvdXQvbWl4aW4vdnVlLWRldmV4JwppbXBvcnQgeyBCdXNNb2R1bGUgfSBmcm9tICdAL3N0b3JlL21vZHVsZXMvYnVzJwppbXBvcnQgeyBEcml2ZXJNb2R1bGUgfSBmcm9tICdAL3N0b3JlL21vZHVsZXMvZHJpdmVyJwppbXBvcnQgeyBCdXNSb3V0ZU1vZHVsZSB9IGZyb20gJ0Avc3RvcmUvbW9kdWxlcy9idXMtcm91dGUnCmltcG9ydCB7IEJ1c1NjaGVkdWxlTW9kdWxlIH0gZnJvbSAnQC9zdG9yZS9tb2R1bGVzL3NjaGVkdWxlJwoKQENvbXBvbmVudCh7CiAgbmFtZTogJ1NjaGVkdWxlVGFibGUnLAogIGNvbXBvbmVudHM6IHsKICB9Cn0pCmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgbWl4aW5zKFZ1ZURldmV4KSB7CiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpCiAgICBzdXBlci5kYXRhR3JpZFJlZktleSA9IHRoaXMuZ3JpZFJlZktleQogICAgc3VwZXIudGFibGVOYW1lID0gJ0J1cyBTY2hlZHVsZScKICB9CgogIEBQcm9wKCkgZHJpdmVySWRQcm9wITogYW55CgogIHByaXZhdGUgZ3JpZFJlZktleSA9ICdzY2hlZHVsZUdyaWQnOwoKICBnZXQgZHJpdmVycygpIHsKICAgIHJldHVybiBEcml2ZXJNb2R1bGUuZHJpdmVycwogIH0KCiAgZ2V0IGJ1c2VzKCkgewogICAgcmV0dXJuIEJ1c01vZHVsZS5idXNlcwogIH0KCiAgZ2V0IGJ1c1JvdXRlcygpIHsKICAgIHJldHVybiBCdXNSb3V0ZU1vZHVsZS5idXNSb3V0ZXMKICB9CgogIGdldCBzY2hlZHVsZXMoKSB7CiAgICByZXR1cm4gQnVzU2NoZWR1bGVNb2R1bGUuc2NoZWR1bGUuc29ydCgoYSwgYikgPT4gewogICAgICBpZiAobmV3IERhdGUoYS5kYXRldGltZSkgPiBuZXcgRGF0ZShiLmRhdGV0aW1lKSkgewogICAgICAgIHJldHVybiAtMQogICAgICB9CiAgICAgIHJldHVybiAwCiAgICB9KQogIH0KCiAgcHJpdmF0ZSB0aGlzUm91dGUocm91dGVJZDogbnVtYmVyKSB7CiAgICByZXR1cm4gQnVzUm91dGVNb2R1bGUuYnVzUm91dGVzLmZpbmQocm91dGUgPT4gcm91dGUuaWQgPT09IHJvdXRlSWQpCiAgfQoKICBwcml2YXRlIGFzeW5jIGdldExpc3QoKSB7CiAgICB0aGlzLmxpc3RMb2FkaW5nID0gdHJ1ZQogICAgYXdhaXQgQnVzTW9kdWxlLmdldEJ1c2VzKCkKICAgIGF3YWl0IERyaXZlck1vZHVsZS5nZXREcml2ZXJzKCkKICAgIGF3YWl0IEJ1c1JvdXRlTW9kdWxlLmdldFJvdXRlcygpCiAgICBhd2FpdCBCdXNTY2hlZHVsZU1vZHVsZS5nZXRCdXNTY2hlZHVsZXMoKQogICAgdGhpcy5saXN0TG9hZGluZyA9IGZhbHNlCiAgfQoKICBwcml2YXRlIG9uQ2VsbENsaWNrKGU6IGFueSkgewogICAgaWYgKGUuY29sdW1uLm5hbWUgPT09ICdidXMnKSB7CiAgICAgIGNvbnN0IGJ1c0lkID0gZS5kYXRhLmJ1cwogICAgICBjb25zb2xlLmxvZyhgYnVzOiAke2J1c0lkfWApCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAnQnVzZXMnLAogICAgICAgIHBhcmFtczogeyBidXNJZFByb3A6IGJ1c0lkLnRvU3RyaW5nKCkgfQogICAgICB9KQogICAgfSBlbHNlIGlmIChlLmNvbHVtbi5uYW1lID09PSAnZHJpdmVyJykgewogICAgICBjb25zdCBkcml2ZXJJZCA9IGUuZGF0YS5kcml2ZXIKICAgICAgY29uc29sZS5sb2coYGRyaXZlcjogJHtkcml2ZXJJZH1gKQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ0RyaXZlcnMnLAogICAgICAgIHBhcmFtczogeyBkcml2ZXJJZFByb3A6IGRyaXZlcklkLnRvU3RyaW5nKCkgfQogICAgICB9KQogICAgfQogIH0KCiAgLy8gVGhlc2UgbWV0aG9kIHdpbGwgZ2V0IG1lcmdlZCB3aXRoIHRoZSBWdWVEZXZleCBtaXhpbidzIG1ldGhvZAogIG9uSW5pdE5ld1JvdygpIHsKICAgIHRocm93IG5ldyBFcnJvcignTWV0aG9kIG5vdCBpbXBsZW1lbnRlZC4nKQogIH0KCiAgcHJpdmF0ZSBhc3luYyBvblNhdmluZyhlOiBhbnkpIHsKICAgIHRoaXMubGlzdExvYWRpbmcgPSB0cnVlCiAgICB0cnkgewogICAgICBjb25zdCBjaGFuZ2VzID0gZS5jaGFuZ2VzWzBdCiAgICAgIGNvbnNvbGUuZGVidWcoY2hhbmdlcykKICAgICAgaWYgKGNoYW5nZXMudHlwZSA9PT0gJ2luc2VydCcpIHsKICAgICAgICBhd2FpdCBCdXNTY2hlZHVsZU1vZHVsZS5hZGRCdXNTY2hlZHVsZShjaGFuZ2VzLmRhdGEpCiAgICAgIH0gZWxzZSBpZiAoY2hhbmdlcy50eXBlID09PSAndXBkYXRlJykgewogICAgICAgIGNvbnNvbGUubG9nKGNoYW5nZXMpCiAgICAgICAgYXdhaXQgQnVzU2NoZWR1bGVNb2R1bGUudXBkYXRlQnVzU2NlZHVsZSh7IGlkOiBjaGFuZ2VzLmtleSwgZGF0YTogY2hhbmdlcy5kYXRhIH0pCiAgICAgIH0KICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICB0aXRsZTogJ1N1Y2Nlc3MnLAogICAgICAgIG1lc3NhZ2U6ICdEYXRhIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5JywKICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgZHVyYXRpb246IDIwMDAKICAgICAgfSkKICAgICAgaWYgKGUuY2hhbmdlc1swXS50eXBlID09PSAnaW5zZXJ0JykgewogICAgICAgIGF3YWl0IHRoaXMuZ2V0TGlzdCgpCiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICB0aXRsZTogJ0ZhaWxlZCcsCiAgICAgICAgbWVzc2FnZTogJ0RhdGEgdXBkYXRlZCBmYWlsZWQnLAogICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgZHVyYXRpb246IDIwMDAKICAgICAgfSkKICAgIH0KICAgIGUuY2FuY2VsID0gdHJ1ZQogICAgdGhpcy5saXN0TG9hZGluZyA9IGZhbHNlCiAgfQoKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRMaXN0KCkgLy8gdGFibGUgZGF0YQogIH0KCiAgQFdhdGNoKCdkcml2ZXJJZFByb3AnKQogIE9uRHJpdmVySWRQcm9wQ2hhbmdlKHZhbDogc3RyaW5nLCBvbGRWYWw6IHN0cmluZykgewogICAgY29uc29sZS5sb2coCiAgICAgIGBkcml2ZXJJZFByb3AgcHJvcHMgY2hhbmdlZCBmcm9tICR7b2xkVmFsfSB0byAke3ZhbH1gCiAgICApCiAgfQoKICBAV2F0Y2goJ2NsZWFyRmlsdGVyVHJpZ2dlcmVkJykKICBPbkNsZWFyRmlsdGVyVHJpZ2dlcmVkKHZhbDogYm9vbGVhbikgewogICAgaWYgKHZhbCkgewogICAgICB0aGlzLmRyaXZlcklkUHJvcCA9IHVuZGVmaW5lZAogICAgfQogIH0KfQo="},{"version":3,"sources":["table.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"table.vue","sourceRoot":"src/views/schedule/components","sourcesContent":["<!--\n  DevEx Component\n-->\n\n<template>\n  <div class=\"table-holder\">\n    <DxLoadPanel :position=\"loadPanelPosition\" :visible=\"listLoading\" />\n    <dx-data-grid\n      id=\"gridContainer\"\n      class=\"grid\"\n      key-expr=\"id\"\n      :ref=\"dataGridRefKey\"\n      :data-source=\"schedules\"\n      :show-borders=\"true\"\n      :show-column-lines=\"true\"\n      :row-alternation-enabled=\"true\"\n      :column-auto-width=\"true\"\n      :cell-hint-enabled=\"true\"\n      :allow-column-resizing=\"true\"\n      :allow-column-reordering=\"true\"\n      @saving=\"onSaving\"\n      @exporting=\"exportGrid\"\n      @toolbar-preparing=\"onToolbarPreparing\"\n      @editor-prepared=\"onEditorPrepared\"\n      @edit-canceling=\"onEditCanceling\"\n      @init-new-row=\"onInitNewRow\"\n      @cell-click=\"onCellClick\"\n    >\n      <DxFilterRow :visible=\"true\" />\n      <DxSearchPanel :visible=\"true\" />\n      <DxGroupPanel :visible=\"false\" />\n      <DxExport :enabled=\"true\" />\n      <DxColumnChooser :enabled=\"true\" />\n\n      <DxEditing\n        mode=\"popup\"\n        :allow-adding=\"getEditAccess\"\n        :allow-deleting=\"false\"\n        :allow-updating=\"getEditAccess\"\n      >\n        <DxPopup\n          :show-title=\"true\"\n          :width=\"700\"\n          :height=\"525\"\n          :title=\"popUpTitle\"\n        />\n        <DxForm>\n          <DxItem :col-count=\"2\" :col-span=\"2\" item-type=\"group\">\n            <DxItem data-field=\"bus\" />\n            <DxItem data-field=\"driver\" />\n            <DxItem data-field=\"datetime\" />\n          </DxItem>\n          <DxItem :col-count=\"1\" :col-span=\"2\" item-type=\"group\">\n            <DxItem data-field=\"busRoute\"/>\n          </DxItem>\n        </DxForm>\n      </DxEditing>\n      <!-- <DxColumn :group-index=\"0\" data-field=\"Product\" /> -->\n      <dx-column\n        data-field=\"id\"\n        :caption=\"$t('general.id')\"\n        data-type=\"number\"\n        alignment=\"right\"\n        :allow-editing=\"false\"\n        header-cell-template=\"title-header\"\n        :width=\"100\"\n        :hidden=\"true\"\n      />\n      <dx-column\n        data-field=\"bus\"\n        data-type=\"number\"\n        header-cell-template=\"title-header\"\n        :caption=\"$t('bus.bus')\"\n        cell-template=\"cellTemplate\"\n        :width=\"200\"\n      >\n        <dx-lookup\n          :data-source=\"buses\"\n          value-expr=\"id\"\n          display-expr=\"name\"\n        />\n        <DxRequiredRule />\n      </dx-column>\n      <dx-column\n        data-field=\"driver\"\n        data-type=\"number\"\n        header-cell-template=\"title-header\"\n        :caption=\"$t('driver.driver')\"\n        cell-template=\"cellTemplate\"\n        :width=\"200\"\n      >\n        <dx-lookup\n          :data-source=\"drivers\"\n          value-expr=\"id\"\n          display-expr=\"name\"\n        />\n        <DxRequiredRule />\n      </dx-column>\n      <dx-column\n        data-field=\"datetime\"\n        data-type=\"datetime\"\n        header-cell-template=\"title-header\"\n        :caption=\"$t('bus.schedule')\"\n        :width=\"200\"\n      >\n        <DxRequiredRule />\n      </dx-column>\n      <dx-column\n        data-field=\"busRoute\"\n        data-type=\"number\"\n        header-cell-template=\"title-header\"\n        :caption=\"$t('bus.route')\"\n        :width=\"500\"\n        cell-template=\"routeCellTemplate\"\n      >\n       <dx-lookup\n          :data-source=\"busRoutes\"\n          value-expr=\"id\"\n          display-expr=\"checkpoints\"\n        />\n        <DxRequiredRule />\n      </dx-column>\n      <dx-column type=\"buttons\">\n        <DxButton name=\"edit\" />\n      </dx-column>\n      <dx-group-panel :visible=\"true\" />\n      <dx-grouping :auto-expand-all=\"false\" />\n      <dx-pager\n        :visible=\"true\"\n        :allowed-page-sizes=\"pageSizes\"\n        :show-page-size-selector=\"true\"\n      />\n      <dx-paging :page-size=\"50\" />\n\n      <template #title-header=\"{data}\">\n        <div class=\"table-header\">\n          <p class=\"table-header-text\">{{ data.column.caption }}</p>\n        </div>\n      </template>\n      <template #cellTemplate=\"{data}\">\n        <div :title=\"data.text\" style=\"cursor: pointer;color: blue;\">\n          <a>{{ data.text }}</a>\n        </div>\n      </template>\n      <template #statusTemplate=\"{data}\">\n        <el-tag :type=\"data.text | statusFilter\">\n          {{ data.text }}\n        </el-tag>\n      </template>\n      <template #routeCellTemplate=\"{data}\">\n        <p>\n          <span v-for=\"(item, index) in thisRoute(data.data.route).checkpoints\" :key=\"index\">\n            <span v-if=\"index === 0\">{{ item }}</span>\n            <span v-else> -> {{ item }}</span>\n          </span>\n        </p>\n      </template>\n    </dx-data-grid>\n  </div>\n</template>\n\n<script lang=\"ts\">\n/**\n * @DevEx_component\n */\nimport { Component, Prop, Watch } from 'vue-property-decorator'\nimport { mixins } from 'vue-class-component'\nimport VueDevex from '@/layout/mixin/vue-devex'\nimport { BusModule } from '@/store/modules/bus'\nimport { DriverModule } from '@/store/modules/driver'\nimport { BusRouteModule } from '@/store/modules/bus-route'\nimport { BusScheduleModule } from '@/store/modules/schedule'\n\n@Component({\n  name: 'ScheduleTable',\n  components: {\n  }\n})\nexport default class extends mixins(VueDevex) {\n  constructor() {\n    super()\n    super.dataGridRefKey = this.gridRefKey\n    super.tableName = 'Bus Schedule'\n  }\n\n  @Prop() driverIdProp!: any\n\n  private gridRefKey = 'scheduleGrid';\n\n  get drivers() {\n    return DriverModule.drivers\n  }\n\n  get buses() {\n    return BusModule.buses\n  }\n\n  get busRoutes() {\n    return BusRouteModule.busRoutes\n  }\n\n  get schedules() {\n    return BusScheduleModule.schedule.sort((a, b) => {\n      if (new Date(a.datetime) > new Date(b.datetime)) {\n        return -1\n      }\n      return 0\n    })\n  }\n\n  private thisRoute(routeId: number) {\n    return BusRouteModule.busRoutes.find(route => route.id === routeId)\n  }\n\n  private async getList() {\n    this.listLoading = true\n    await BusModule.getBuses()\n    await DriverModule.getDrivers()\n    await BusRouteModule.getRoutes()\n    await BusScheduleModule.getBusSchedules()\n    this.listLoading = false\n  }\n\n  private onCellClick(e: any) {\n    if (e.column.name === 'bus') {\n      const busId = e.data.bus\n      console.log(`bus: ${busId}`)\n      this.$router.push({\n        name: 'Buses',\n        params: { busIdProp: busId.toString() }\n      })\n    } else if (e.column.name === 'driver') {\n      const driverId = e.data.driver\n      console.log(`driver: ${driverId}`)\n      this.$router.push({\n        name: 'Drivers',\n        params: { driverIdProp: driverId.toString() }\n      })\n    }\n  }\n\n  // These method will get merged with the VueDevex mixin's method\n  onInitNewRow() {\n    throw new Error('Method not implemented.')\n  }\n\n  private async onSaving(e: any) {\n    this.listLoading = true\n    try {\n      const changes = e.changes[0]\n      console.debug(changes)\n      if (changes.type === 'insert') {\n        await BusScheduleModule.addBusSchedule(changes.data)\n      } else if (changes.type === 'update') {\n        console.log(changes)\n        await BusScheduleModule.updateBusScedule({ id: changes.key, data: changes.data })\n      }\n      this.$notify({\n        title: 'Success',\n        message: 'Data updated successfully',\n        type: 'success',\n        duration: 2000\n      })\n      if (e.changes[0].type === 'insert') {\n        await this.getList()\n      }\n    } catch (e) {\n      this.$notify({\n        title: 'Failed',\n        message: 'Data updated failed',\n        type: 'error',\n        duration: 2000\n      })\n    }\n    e.cancel = true\n    this.listLoading = false\n  }\n\n  created() {\n    this.getList() // table data\n  }\n\n  @Watch('driverIdProp')\n  OnDriverIdPropChange(val: string, oldVal: string) {\n    console.log(\n      `driverIdProp props changed from ${oldVal} to ${val}`\n    )\n  }\n\n  @Watch('clearFilterTriggered')\n  OnClearFilterTriggered(val: boolean) {\n    if (val) {\n      this.driverIdProp = undefined\n    }\n  }\n}\n</script>\n\n<style>\n.grid {\n  width: 93%;\n  align-self: center;\n  margin-left: 3.5%;\n}\n.dx-searchbox .dx-icon-search {\n  left: 0px;\n}\n.dx-texteditor-input {\n  margin-left: 15px;\n}\n.dx-placeholder:before {\n  margin-left: 15px;\n}\n.dx-searchbox .dx-texteditor-input,\n.dx-searchbox .dx-placeholder:before {\n  padding-left: 8px;\n  padding-right: 68px;\n}\n.table-header {\n  font-size: 15px;\n  color: black;\n}\n</style>\n"]}]}