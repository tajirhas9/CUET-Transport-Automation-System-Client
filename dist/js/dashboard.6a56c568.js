(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dashboard"],{"06ae":function(t,e,a){"use strict";a("588b")},"23cc":function(t,e,a){"use strict";a("deec")},"3add":function(t,e,a){"use strict";a("d304")},"588b":function(t,e,a){},9406:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-container"},[a(t.currentRole,{tag:"component"})],1)},r=[],i=a("d4ec"),s=a("bee2"),c=a("262e"),l=a("2caf"),o=a("9ab4"),u=a("1b40"),d=a("9dba"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-editor-container"},[a("panel-group",{on:{"handle-set-line-chart-data":t.handleSetLineChartData}}),a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{xs:48,sm:48,lg:24}},[a("div",{staticClass:"chart-wrapper"},[a("pie-chart")],1)])],1),a("el-row",{attrs:{gutter:32}},[a("el-col",{staticStyle:{"text-align":"center"},attrs:{xs:48,sm:48,lg:24}},[a("p",{staticStyle:{"background-color":"white",padding:"20px","text-align":"center"}},[t._v("Today's Schedule")]),a("today-schedule")],1)],1)],1)},h=[],b=a("1da1"),v=(a("96cf"),a("14fd")),f=a("4f6e"),m=(a("817d"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticClass:"panel-group",attrs:{gutter:40}},[a("el-col",{staticClass:"card-panel-col",attrs:{xs:16,sm:16,lg:8}},[a("div",{staticClass:"card-panel",on:{click:function(e){return t.handleSetLineChartData("newVisitis")}}},[a("div",{staticClass:"card-panel-icon-wrapper icon-people"},[a("svg-icon",{staticClass:"card-panel-icon",attrs:{name:"bus"}})],1),a("div",{staticClass:"card-panel-description"},[a("div",{staticClass:"card-panel-text"},[t._v(" "+t._s(t.$t("bus.totalBus"))+" ")]),a("count-to",{staticClass:"card-panel-num",attrs:{"start-val":0,"end-val":t.totalBus,duration:2600}})],1)])]),a("el-col",{staticClass:"card-panel-col",attrs:{xs:16,sm:16,lg:8}},[a("div",{staticClass:"card-panel",on:{click:function(e){return t.handleSetLineChartData("messages")}}},[a("div",{staticClass:"card-panel-icon-wrapper icon-message"},[a("svg-icon",{staticClass:"card-panel-icon",attrs:{name:"driver"}})],1),a("div",{staticClass:"card-panel-description"},[a("div",{staticClass:"card-panel-text"},[t._v(" "+t._s(t.$t("driver.totalDriver"))+" ")]),a("count-to",{staticClass:"card-panel-num",attrs:{"start-val":0,"end-val":t.totalDriver,duration:3e3}})],1)])]),a("el-col",{staticClass:"card-panel-col",attrs:{xs:16,sm:16,lg:8}},[a("div",{staticClass:"card-panel",on:{click:function(e){return t.handleSetLineChartData("purchases")}}},[a("div",{staticClass:"card-panel-icon-wrapper icon-money"},[a("svg-icon",{staticClass:"card-panel-icon",attrs:{name:"peoples"}})],1),a("div",{staticClass:"card-panel-description"},[a("div",{staticClass:"card-panel-text"},[t._v(" "+t._s(t.$t("bus.totalSeat"))+" ")]),a("count-to",{staticClass:"card-panel-num",attrs:{"start-val":0,"end-val":t.seatCapacity,duration:3200}})],1)])]),a("el-col",{staticClass:"card-panel-col",attrs:{xs:16,sm:16,lg:6}})],1)}),g=[],y=a("ec1b"),x=a.n(y),O=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(i["a"])(this,a),e.apply(this,arguments)}return Object(s["a"])(a,[{key:"totalBus",get:function(){return v["a"].buses.length}},{key:"totalDriver",get:function(){return f["a"].drivers.length}},{key:"seatCapacity",get:function(){return 60*v["a"].buses.length}},{key:"handleSetLineChartData",value:function(t){this.$emit("handle-set-line-chart-data",t)}}]),a}(u["c"]);O=Object(o["a"])([Object(u["a"])({name:"PanelGroup",components:{CountTo:x.a}})],O);var j=O,C=j,w=(a("06ae"),a("2877")),k=Object(w["a"])(C,m,g,!1,null,"06b6b038",null),R=k.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.className,style:{height:t.height,width:t.width}})},_=[],E=(a("4de4"),a("d3b7"),a("313e")),S=a("2fe1"),z=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(i["a"])(this,a),e.apply(this,arguments)}return Object(s["a"])(a,[{key:"mounted",value:function(){this.initResizeEvent(),this.initSidebarResizeEvent()}},{key:"beforeDestroy",value:function(){this.destroyResizeEvent(),this.destroySidebarResizeEvent()}},{key:"activated",value:function(){this.initResizeEvent(),this.initSidebarResizeEvent()}},{key:"deactivated",value:function(){this.destroyResizeEvent(),this.destroySidebarResizeEvent()}},{key:"chartResizeHandler",value:function(){this.chart&&this.chart.resize()}},{key:"sidebarResizeHandler",value:function(t){"width"===t.propertyName&&this.chartResizeHandler()}},{key:"initResizeEvent",value:function(){this.chartResizeHandler&&window.addEventListener("resize",this.chartResizeHandler)}},{key:"destroyResizeEvent",value:function(){this.chartResizeHandler&&window.removeEventListener("resize",this.chartResizeHandler)}},{key:"initSidebarResizeEvent",value:function(){this.sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.sidebarElm&&this.sidebarElm.addEventListener("transitionend",this.sidebarResizeHandler)}},{key:"destroySidebarResizeEvent",value:function(){this.sidebarElm&&this.sidebarElm.removeEventListener("transitionend",this.sidebarResizeHandler)}}]),a}(u["c"]);z=Object(o["a"])([Object(u["a"])({name:"ResizeMixin"})],z);var L=z,T=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(i["a"])(this,a),e.apply(this,arguments)}return Object(s["a"])(a,[{key:"mounted",value:function(){var t=this;this.$nextTick((function(){t.initChart()}))}},{key:"beforeDestroy",value:function(){this.chart&&(this.chart.dispose(),this.chart=null)}},{key:"initChart",value:function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.chart=E["init"](this.$el),this.chart.setOption({tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{left:"center",bottom:"10",data:["Inactive","Active"]},series:[{name:"BUS STATUS",type:"pie",roseType:"radius",radius:[15,95],center:["50%","38%"],data:[{value:v["a"].buses.filter((function(t){return!t.status})).length,name:"Inactive"},{value:v["a"].buses.filter((function(t){return t.status})).length,name:"Active"}],animationEasing:"cubicInOut",animationDuration:2600}]});case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),a}(Object(S["c"])(L));Object(o["a"])([Object(u["b"])({default:"chart"})],T.prototype,"className",void 0),Object(o["a"])([Object(u["b"])({default:"100%"})],T.prototype,"width",void 0),Object(o["a"])([Object(u["b"])({default:"300px"})],T.prototype,"height",void 0),T=Object(o["a"])([Object(u["a"])({name:"PieChart"})],T);var $=T,I=$,P=Object(w["a"])(I,D,_,!1,null,null,null),B=P.exports,G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table-holder"},[a("DxLoadPanel",{attrs:{position:t.loadPanelPosition,visible:t.listLoading}}),a("dx-data-grid",{ref:t.dataGridRefKey,staticClass:"grid",attrs:{id:"gridContainer","key-expr":"id","data-source":t.schedules,"show-borders":!0,"show-column-lines":!0,"row-alternation-enabled":!0,"column-auto-width":!0,"cell-hint-enabled":!0,"allow-column-resizing":!0,"allow-column-reordering":!0},on:{saving:t.onSaving,exporting:t.exportGrid,"toolbar-preparing":t.onToolbarPreparing,"editor-prepared":t.onEditorPrepared,"edit-canceling":t.onEditCanceling,"init-new-row":t.onInitNewRow,"cell-click":t.onCellClick},scopedSlots:t._u([{key:"title-header",fn:function(e){var n=e.data;return[a("div",{staticClass:"table-header"},[a("p",{staticClass:"table-header-text"},[t._v(t._s(n.column.caption))])])]}},{key:"cellTemplate",fn:function(e){var n=e.data;return[a("div",{staticStyle:{cursor:"pointer",color:"blue"},attrs:{title:n.text}},[a("a",[t._v(t._s(n.text))])])]}},{key:"statusTemplate",fn:function(e){var n=e.data;return[a("el-tag",{attrs:{type:t._f("statusFilter")(n.text)}},[t._v(" "+t._s(n.text)+" ")])]}},{key:"routeCellTemplate",fn:function(e){var n=e.data;return[a("p",t._l(t.thisRoute(n.data.route).checkpoints,(function(e,n){return a("span",{key:n},[a("span",0===n?[t._v(t._s(e))]:[t._v(" -> "+t._s(e))])])})),0)]}}])},[a("DxFilterRow",{attrs:{visible:!0}}),a("DxSearchPanel",{attrs:{visible:!0}}),a("DxGroupPanel",{attrs:{visible:!1}}),a("DxExport",{attrs:{enabled:!0}}),a("DxColumnChooser",{attrs:{enabled:!0}}),a("DxEditing",{attrs:{mode:"popup","allow-adding":t.getEditAccess,"allow-deleting":!1,"allow-updating":t.getEditAccess}},[a("DxPopup",{attrs:{"show-title":!0,width:700,height:525,title:t.popUpTitle}}),a("DxForm",[a("DxItem",{attrs:{"col-count":2,"col-span":2,"item-type":"group"}},[a("DxItem",{attrs:{"data-field":"bus"}}),a("DxItem",{attrs:{"data-field":"driver"}}),a("DxItem",{attrs:{"data-field":"datetime"}})],1),a("DxItem",{attrs:{"col-count":1,"col-span":2,"item-type":"group"}},[a("DxItem",{attrs:{"data-field":"busRoute"}})],1)],1)],1),a("dx-column",{attrs:{"data-field":"id",caption:t.$t("general.id"),"data-type":"number",alignment:"right","allow-editing":!1,"header-cell-template":"title-header",width:100,hidden:!0}}),a("dx-column",{attrs:{"data-field":"bus","data-type":"number","header-cell-template":"title-header",caption:t.$t("bus.bus"),"cell-template":"cellTemplate",width:300}},[a("dx-lookup",{attrs:{"data-source":t.buses,"value-expr":"id","display-expr":"name"}}),a("DxRequiredRule")],1),a("dx-column",{attrs:{"data-field":"driver","data-type":"number","header-cell-template":"title-header",caption:t.$t("driver.driver"),"cell-template":"cellTemplate",width:300}},[a("dx-lookup",{attrs:{"data-source":t.drivers,"value-expr":"id","display-expr":"name"}}),a("DxRequiredRule")],1),a("dx-column",{attrs:{"data-field":"datetime","data-type":"datetime","header-cell-template":"title-header",caption:t.$t("bus.schedule"),width:300}},[a("DxRequiredRule")],1),a("dx-column",{attrs:{"data-field":"busRoute","data-type":"number","header-cell-template":"title-header",caption:t.$t("bus.route"),width:550,"cell-template":"routeCellTemplate"}},[a("dx-lookup",{attrs:{"data-source":t.busRoutes,"value-expr":"id","display-expr":"checkpoints"}}),a("DxRequiredRule")],1),a("dx-column",{attrs:{type:"buttons"}},[a("DxButton",{attrs:{name:"edit"}})],1),a("dx-group-panel",{attrs:{visible:!0}}),a("dx-grouping",{attrs:{"auto-expand-all":!1}}),a("dx-pager",{attrs:{visible:!0,"allowed-page-sizes":t.pageSizes,"show-page-size-selector":!0}}),a("dx-paging",{attrs:{"page-size":50}})],1)],1)},F=[],H=a("257e"),A=a("1341"),M=a("7e84"),N=(a("0d03"),a("4e82"),a("7db0"),a("b0c0"),a("25f0"),a("99af"),a("a113")),q=a("af097"),K=a("faeb"),U=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t,n,r;return Object(i["a"])(this,a),r=e.call(this),r.gridRefKey="scheduleGrid",r.isToday=function(t){var e=new Date;return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()},Object(A["a"])((t=Object(H["a"])(r),Object(M["a"])(a.prototype)),"dataGridRefKey",r.gridRefKey,t,!0),Object(A["a"])((n=Object(H["a"])(r),Object(M["a"])(a.prototype)),"tableName","Bus Schedule",n,!0),r}return Object(s["a"])(a,[{key:"drivers",get:function(){return f["a"].drivers}},{key:"buses",get:function(){return v["a"].buses}},{key:"busRoutes",get:function(){return q["a"].busRoutes}},{key:"schedules",get:function(){var t=this;return K["a"].schedule.filter((function(e){return t.isToday(new Date(e.datetime))})).sort((function(t,e){return new Date(t.datetime)>new Date(e.datetime)?-1:0}))}},{key:"thisRoute",value:function(t){return q["a"].busRoutes.find((function(e){return e.id===t}))}},{key:"getList",value:function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.listLoading=!0,t.next=3,v["a"].getBuses();case 3:return t.next=5,f["a"].getDrivers();case 5:return t.next=7,q["a"].getRoutes();case 7:return t.next=9,K["a"].getBusSchedules();case 9:this.listLoading=!1;case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"onCellClick",value:function(t){if("bus"===t.column.name){var e=t.data.bus;console.log("bus: ".concat(e)),this.$router.push({name:"Buses",params:{busIdProp:e.toString()}})}else if("driver"===t.column.name){var a=t.data.driver;console.log("driver: ".concat(a)),this.$router.push({name:"Drivers",params:{driverIdProp:a.toString()}})}}},{key:"onInitNewRow",value:function(){throw new Error("Method not implemented.")}},{key:"onSaving",value:function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(e){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.listLoading=!0,t.prev=1,a=e.changes[0],console.debug(a),"insert"!==a.type){t.next=9;break}return t.next=7,K["a"].addBusSchedule(a.data);case 7:t.next=13;break;case 9:if("update"!==a.type){t.next=13;break}return console.log(a),t.next=13,K["a"].updateBusScedule({id:a.key,data:a.data});case 13:if(this.$notify({title:"Success",message:"Data updated successfully",type:"success",duration:2e3}),"insert"!==e.changes[0].type){t.next=17;break}return t.next=17,this.getList();case 17:t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](1),this.$notify({title:"Failed",message:"Data updated failed",type:"error",duration:2e3});case 22:e.cancel=!0,this.listLoading=!1;case 24:case"end":return t.stop()}}),t,this,[[1,19]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.getList()}},{key:"OnDriverIdPropChange",value:function(t,e){console.log("driverIdProp props changed from ".concat(e," to ").concat(t))}},{key:"OnClearFilterTriggered",value:function(t){t&&(this.driverIdProp=void 0)}}]),a}(Object(S["c"])(N["a"]));Object(o["a"])([Object(u["b"])()],U.prototype,"driverIdProp",void 0),Object(o["a"])([Object(u["d"])("driverIdProp")],U.prototype,"OnDriverIdPropChange",null),Object(o["a"])([Object(u["d"])("clearFilterTriggered")],U.prototype,"OnClearFilterTriggered",null),U=Object(o["a"])([Object(u["a"])({name:"TodaySchedule",components:{}})],U);var Y=U,J=Y,V=(a("23cc"),Object(w["a"])(J,G,F,!1,null,null,null)),Z=V.exports,Q=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(i["a"])(this,a),e.apply(this,arguments)}return Object(s["a"])(a,[{key:"handleSetLineChartData",value:function(){}},{key:"init",value:function(){var t=Object(b["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,v["a"].getBuses();case 2:return t.next=4,f["a"].getDrivers();case 4:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){this.init()}}]),a}(u["c"]);Q=Object(o["a"])([Object(u["a"])({name:"DashboardAdmin",components:{PanelGroup:R,PieChart:B,TodaySchedule:Z}})],Q);var W=Q,X=W,tt=(a("3add"),Object(w["a"])(X,p,h,!1,null,"956ff168",null)),et=tt.exports,at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-editor-container"},[a("div",{staticClass:"clearfix"},[a("pan-thumb",{staticStyle:{float:"left"}},[t._v(" Your roles: ")]),a("github-corner",{staticStyle:{position:"absolute",top:"0px",border:"0",right:"0"}}),a("div",{staticClass:"info-container"},[a("span",{staticClass:"display_name"},[t._v(t._s(t.name))]),a("span",{staticStyle:{"font-size":"20px","padding-top":"20px",display:"inline-block"}},[t._v("Editor's Dashboard")])])],1),a("div",[a("img",{staticClass:"emptyGif",attrs:{src:t.emptyGif}})])])},nt=[],rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pan-item",style:{zIndex:t.zIndex,height:t.height,width:t.width}},[a("div",{staticClass:"pan-info"},[a("div",{staticClass:"pan-info-roles-container"},[t._t("default")],2)])])},it=[],st=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(i["a"])(this,a),e.apply(this,arguments)}return Object(s["a"])(a)}(u["c"]);Object(o["a"])([Object(u["b"])({default:"150px"})],st.prototype,"width",void 0),Object(o["a"])([Object(u["b"])({default:"150px"})],st.prototype,"height",void 0),Object(o["a"])([Object(u["b"])({default:1})],st.prototype,"zIndex",void 0),st=Object(o["a"])([Object(u["a"])({name:"PanThumb"})],st);var ct=st,lt=ct,ot=(a("c441"),Object(w["a"])(lt,rt,it,!1,null,"8bd38b58",null)),ut=ot.exports,dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{staticClass:"github-corner",attrs:{href:"https://github.com/armour/vue-typescript-admin-template",target:"_blank","aria-label":"View source on Github"}},[a("svg",{staticStyle:{fill:"#40c9c6",color:"#fff"},attrs:{width:"80",height:"80",viewBox:"0 0 250 250","aria-hidden":"true"}},[a("path",{attrs:{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}}),a("path",{staticClass:"octo-arm",staticStyle:{"transform-origin":"130px 106px"},attrs:{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor"}}),a("path",{staticClass:"octo-body",attrs:{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"}})])])},pt=[],ht=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){return Object(i["a"])(this,a),e.apply(this,arguments)}return Object(s["a"])(a)}(u["c"]);ht=Object(o["a"])([Object(u["a"])({name:"GithubCorner"})],ht);var bt=ht,vt=bt,ft=(a("fd10"),Object(w["a"])(vt,dt,pt,!1,null,"1c8186b6",null)),mt=ft.exports,gt=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.emptyGif="https://wpimg.wallstcn.com/0e03b7da-db9e-4819-ba10-9016ddfdaed3",t}return Object(s["a"])(a,[{key:"name",get:function(){return d["a"].username}},{key:"role",get:function(){return d["a"].role}}]),a}(u["c"]);gt=Object(o["a"])([Object(u["a"])({name:"DashboardEditor",components:{PanThumb:ut,GithubCorner:mt}})],gt);var yt=gt,xt=yt,Ot=(a("c7de"),Object(w["a"])(xt,at,nt,!1,null,"18fedaae",null)),jt=Ot.exports,Ct=a("f6b0"),wt=function(t){Object(c["a"])(a,t);var e=Object(l["a"])(a);function a(){var t;return Object(i["a"])(this,a),t=e.apply(this,arguments),t.currentRole="admin-dashboard",t}return Object(s["a"])(a,[{key:"role",get:function(){return d["a"].role}},{key:"created",value:function(){this.role!==Ct["a"].admin&&(this.currentRole="editor-dashboard")}}]),a}(u["c"]);wt=Object(o["a"])([Object(u["a"])({name:"Dashboard",components:{AdminDashboard:et,EditorDashboard:jt}})],wt);var kt=wt,Rt=kt,Dt=Object(w["a"])(Rt,n,r,!1,null,null,null);e["default"]=Dt.exports},b21b:function(t,e,a){},b597:function(t,e,a){},c441:function(t,e,a){"use strict";a("b597")},c7de:function(t,e,a){"use strict";a("d9a7")},d304:function(t,e,a){},d9a7:function(t,e,a){},deec:function(t,e,a){},fd10:function(t,e,a){"use strict";a("b21b")}}]);